<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>填寫狀況（Latest）｜仁和國中管樂團</title>
  <meta name="description" content="仁和國中管樂團學生表單填寫狀況（Latest 工作表）即時檢視頁。" />
  <meta name="robots" content="noindex" />
  <style>

:root{
  --bg:#0f1325;
  --card:#ffffff;
  --ink:#111827;
  --ink-soft:#374151;
  --brand:#1b84f2;
  --brand-2:#8b5cf6;
  --muted:#6b7280;
}
*{box-sizing:border-box}
html,body{margin:0;padding:0;height:100%;font-family: -apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Noto Sans TC","PingFang TC","Helvetica Neue",Arial,"Hiragino Sans",sans-serif;background:linear-gradient(180deg, #101739 0%, #0f1325 100%);color:#111827}
.container{min-height:100dvh;display:flex;align-items:center;justify-content:center;padding:24px}
.card{
  width:min(1100px, 92vw);
  background:var(--card);
  color:var(--ink);
  border-radius:20px;
  box-shadow:0 10px 30px rgba(0,0,0,.25), 0 1px 0 rgba(255,255,255,.08) inset;
  overflow:hidden;
  border:1px solid rgba(17,24,39,.06);
}
.card-header{
  display:flex;align-items:center;justify-content:space-between;gap:12px;
  padding:14px 16px;
  background:linear-gradient(90deg, rgba(27,132,242,.12), rgba(139,92,246,.12));
  border-bottom:1px solid rgba(17,24,39,.08);
}
.title{font-weight:800;letter-spacing:.02em;font-size:16px}
.actions{display:flex;align-items:center;gap:8px}
.btn{
  appearance:none;border:1px solid rgba(17,24,39,.12);
  background:#fff;border-radius:12px;padding:8px 12px;font-weight:700;cursor:pointer;
  box-shadow:0 1px 0 rgba(17,24,39,.04),0 8px 20px rgba(27,132,242,.08);
}
.btn:hover{box-shadow:0 1px 0 rgba(17,24,39,.04),0 10px 26px rgba(27,132,242,.16)}
.btn:active{transform:translateY(1px)}
.hint{font-size:12px;color:var(--muted)}
.frame{position:relative;height: min(1200px, calc(100dvh - 64px - 48px));}
.frame iframe{position:absolute;inset:0;width:100%;height:100%;border:0;background:#fff}
@media (max-width:480px){
  .container{padding:10px}
  .title{font-size:14px}
  .btn{padding:6px 10px;font-size:13px}
  .card{width:100%} /* 滿寬起始 */
}

/* 保持與 A/B 頁視覺一致，行動端起始滿寬，允許縮放（已不禁止 user-scalable）。 */
</style>
</head>
<body>
  <div class="container">
    <section class="card" role="region" aria-label="Latest 工作表">
      <div class="card-header">
        <div class="title">仁和國中管樂團｜填寫狀況（Latest）</div>
        <div class="actions">
          <button id="btnReload" class="btn" type="button" aria-label="重新整理">重新整理</button>
          <div id="lastUpdate" class="hint">—</div>
        </div>
      </div>
      <div class="frame">
        <iframe
          id="sheetFrame"
          src="https://docs.google.com/spreadsheets/d/e/2PACX-1vQn22zMVTRxiCraZl8FKALyq7oSG-NH38hnZb7EflMctiL3q8MWf0UxN7JbNgnmRTgARkyX3BJsroP3/pubhtml?gid=1125131152&amp;single=true&amp;widget=true&amp;headers=false"
          referrerpolicy="no-referrer-when-downgrade"
          loading="lazy"
          title="Latest 工作表即時檢視"></iframe>
      </div>
    </section>
  </div>
  <script>
  (function () {
    const frame = document.getElementById('sheetFrame');
    const btn = document.getElementById('btnReload');
    const lastUpdate = document.getElementById('lastUpdate');

    function stamp() {
      const now = new Date();
      const pad = (n) => String(n).padStart(2, '0');
      return `${now.getFullYear()}-${pad(now.getMonth()+1)}-${pad(now.getDate())} ${pad(now.getHours())}:${pad(now.getMinutes())}:${pad(now.getSeconds())}`;
    }
    function updateStamp() { lastUpdate.textContent = `更新於 ${stamp()}`; }
    function hardReloadIframe() {
      const base = "https://docs.google.com/spreadsheets/d/e/2PACX-1vQn22zMVTRxiCraZl8FKALyq7oSG-NH38hnZb7EflMctiL3q8MWf0UxN7JbNgnmRTgARkyX3BJsroP3/pubhtml?gid=1125131152&single=true&widget=true&headers=false";
      frame.src = base + "&v=" + Date.now();
      updateStamp();
    }
    btn.addEventListener('click', hardReloadIframe);
    frame.addEventListener('load', updateStamp);
    setInterval(hardReloadIframe, 5 * 60 * 1000);
  })();
  </script>
</body>
</html>
